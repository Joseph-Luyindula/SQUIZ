{% extends 'base.html' %}

{% block title %}Classement - SQUIZ{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-squiz-dark mb-4">Classement Général</h1>
        <p class="text-xl text-gray-600">Découvrez les meilleurs joueurs de SQUIZ</p>
    </div>

    <!-- Filters -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-lg font-semibold text-squiz-dark mb-4">Filtres</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Pays</label>
                <select id="country-filter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-squiz-blue focus:border-transparent">
                    <option value="">Tous les pays</option>
                    <option value="FR">France</option>
                    <option value="BE">Belgique</option>
                    <option value="CH">Suisse</option>
                    <option value="CA">Canada</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Catégorie de joueur</label>
                <select id="category-filter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-squiz-blue focus:border-transparent">
                    <option value="">Toutes les catégories</option>
                    <option value="S">Diamant (S)</option>
                    <option value="A">Émeraude (A)</option>
                    <option value="B">Rubis (B)</option>
                    <option value="C">Saphir (C)</option>
                    <option value="D">Or (D)</option>
                    <option value="E">Argent (E)</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Catégorie de jeu</label>
                <select id="game-category-filter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-squiz-blue focus:border-transparent">
                    <option value="">Toutes les catégories</option>
                    <option value="sciences">Sciences</option>
                    <option value="histoire">Histoire</option>
                    <option value="sport">Sport</option>
                    <option value="geographie">Géographie</option>
                    <option value="culture">Culture</option>
                    <option value="technologie">Technologie</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Top 3 Podium -->
    <div class="mb-12">
        <div class="flex justify-center items-end space-x-4">
            <!-- 2nd Place -->
            <div class="text-center">
                <div class="bg-gray-300 rounded-lg p-6 mb-4 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold">2</span>
                    </div>
                    <div class="relative inline-block mb-3">
                        <img src="/placeholder.svg?height=80&width=80" alt="Player 2" class="w-20 h-20 rounded-full mx-auto border-4 border-category-gold">
                        <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-category-gold rounded-full flex items-center justify-center">
                            <span class="text-white font-bold text-sm">D</span>
                        </div>
                    </div>
                    <h3 class="font-bold text-lg text-squiz-dark">Joueur2</h3>
                    <p class="text-gray-600">2,450 XP</p>
                </div>
            </div>

            <!-- 1st Place -->
            <div class="text-center">
                <div class="bg-yellow-300 rounded-lg p-6 mb-4 relative transform scale-110">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold">1</span>
                    </div>
                    <i class="fas fa-crown text-yellow-600 text-2xl mb-2"></i>
                    <div class="relative inline-block mb-3">
                        <img src="/placeholder.svg?height=80&width=80" alt="Player 1" class="w-20 h-20 rounded-full mx-auto border-4 border-category-diamond">
                        <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-category-diamond rounded-full flex items-center justify-center">
                            <span class="text-white font-bold text-sm">S</span>
                        </div>
                    </div>
                    <h3 class="font-bold text-lg text-squiz-dark">Champion</h3>
                    <p class="text-gray-600">3,250 XP</p>
                </div>
            </div>

            <!-- 3rd Place -->
            <div class="text-center">
                <div class="bg-orange-300 rounded-lg p-6 mb-4 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold">3</span>
                    </div>
                    <div class="relative inline-block mb-3">
                        <img src="/placeholder.svg?height=80&width=80" alt="Player 3" class="w-20 h-20 rounded-full mx-auto border-4 border-category-emerald">
                        <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-category-emerald rounded-full flex items-center justify-center">
                            <span class="text-white font-bold text-sm">A</span>
                        </div>
                    </div>
                    <h3 class="font-bold text-lg text-squiz-dark">Joueur3</h3>
                    <p class="text-gray-600">2,180 XP</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Rankings Table -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-squiz-dark">Classement complet</h2>
        </div>
        
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Joueur</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Catégorie</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">XP</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pays</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Parties</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200" id="rankings-tbody">
                    {% for player in players %}
                    <tr class="hover:bg-gray-50 player-row" 
                        data-country="{{ player.country }}" 
                        data-category="{{ player.category.letter }}" 
                        data-game-category="{{ player.favorite_category }}">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <span class="text-lg font-bold text-squiz-dark">#{{ forloop.counter|add:3 }}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="relative mr-4">
                                    <img src="{{ player.avatar.url|default:'/placeholder.svg?height=40&width=40' }}" 
                                         alt="{{ player.username }}" 
                                         class="w-10 h-10 rounded-full">
                                    <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-category-{{ player.category.color }} rounded-full flex items-center justify-center">
                                        <span class="text-white font-bold text-xs">{{ player.category.letter }}</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-squiz-dark">{{ player.username }}</div>
                                    <div class="text-sm text-gray-500">{{ player.category.name }}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-category-{{ player.category.color }} text-white">
                                {{ player.category.letter }}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-squiz-dark">
                            {{ player.xp }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <i class="fas fa-flag mr-1"></i>{{ player.country }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            {{ player.total_games }}
                        </td>
                    </tr>
                    {% empty %}
                    <!-- Placeholder rows -->
                    {% for i in "4567891011121314151617181920" %}
                    <tr class="hover:bg-gray-50 player-row" data-country="FR" data-category="E" data-game-category="sciences">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="text-lg font-bold text-squiz-dark">#{{ i }}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="relative mr-4">
                                    <img src="/placeholder.svg?height=40&width=40" alt="Joueur{{ i }}" class="w-10 h-10 rounded-full">
                                    <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-category-silver rounded-full flex items-center justify-center">
                                        <span class="text-white font-bold text-xs">E</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-squiz-dark">Joueur{{ i }}</div>
                                    <div class="text-sm text-gray-500">Argent</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-category-silver text-white">
                                E
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-squiz-dark">
                            {{ i }}50
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <i class="fas fa-flag mr-1"></i>France
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            {{ i }}2
                        </td>
                    </tr>
                    {% endfor %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        <div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6">
            <div class="flex-1 flex justify-between sm:hidden">
                <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    Précédent
                </a>
                <a href="#" class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    Suivant
                </a>
            </div>
            <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                <div>
                    <p class="text-sm text-gray-700">
                        Affichage de <span class="font-medium">1</span> à <span class="font-medium">20</span> sur <span class="font-medium">1,247</span> résultats
                    </p>
                </div>
                <div>
                    <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
                        <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                        <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">1</a>
                        <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-squiz-blue text-sm font-medium text-white">2</a>
                        <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">3</a>
                        <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Filter functionality
    const countryFilter = document.getElementById('country-filter');
    const categoryFilter = document.getElementById('category-filter');
    const gameCategoryFilter = document.getElementById('game-category-filter');
    const playerRows = document.querySelectorAll('.player-row');

    function applyFilters() {
        const selectedCountry = countryFilter.value;
        const selectedCategory = categoryFilter.value;
        const selectedGameCategory = gameCategoryFilter.value;

        playerRows.forEach(row => {
            const country = row.dataset.country;
            const category = row.dataset.category;
            const gameCategory = row.dataset.gameCategory;

            const matchesCountry = !selectedCountry || country === selectedCountry;
            const matchesCategory = !selectedCategory || category === selectedCategory;
            const matchesGameCategory = !selectedGameCategory || gameCategory === selectedGameCategory;

            if (matchesCountry && matchesCategory && matchesGameCategory) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }

    countryFilter.addEventListener('change', applyFilters);
    categoryFilter.addEventListener('change', applyFilters);
    gameCategoryFilter.addEventListener('change', applyFilters);
</script>
{% endblock %}
